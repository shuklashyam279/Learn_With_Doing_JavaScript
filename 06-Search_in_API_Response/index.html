<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Search in API Response</title>
    <link rel="stylesheet" href="../styles.css" />
  </head>
  <body>
    <nav>
      <a href="/" aria-current="page">Home</a>
    </nav>
    <script>

        var listdata;
        const form = document.createElement("form");
        document.body.appendChild(form);

        const searchInput = document.createElement("input");
        searchInput.type = "text";
        searchInput.id = "search_input";
        searchInput.placeholder = "Search";
        searchInput.style.width = "300px"; 
        searchInput.style.height = "50px";
        searchInput.style.fontSize = "20px";
        form.appendChild(searchInput);

        const searchVal = document.getElementById("search_input").value;
        // console.log(searchVal);
        // console.log(typeof searchVal);
        

        
        searchInput.addEventListener("input", (e) => { 
          let arr = []
          document.getElementById("response-list").innerHTML = "";
          listdata.forEach(i => {
            // console.log(e.target.value);
            //lowercase search
            if(i.name.toLowerCase().includes(e.target.value.toLowerCase()) || i.email.toLowerCase().includes(e.target.value.toLowerCase()) || i.username.toLowerCase().includes(e.target.value.toLowerCase())){
              arr.push(i)
              // console.log(i);
            }
          });
          showResponse(arr);
        });


// ---------------------------------------------------------------------------------
      const responseDiv = document.createElement("div");
      responseDiv.id = "response";
      const list = document.createElement("ol");
      list.id = "response-list";
      responseDiv.appendChild(list);
      document.body.appendChild(responseDiv);

      const showResponse = function(responseData) {
        //setting data to session storage
      sessionStorage.setItem("userData", JSON.stringify(listdata));

        // console.log(responseData);
          responseData.forEach(item => {
              const listItem = document.createElement("li");
              listItem.textContent = `Title: ${item.name}, Email: ${item.email}, Username: ${item.username}`;
              list.appendChild(listItem);
          });
        }

//---------------------------------------------------------------------------------

fetch('https://jsonplaceholder.typicode.com/users')
      .then(response => response.json())
      .then(json => {
          listdata = json;
          showResponse(listdata);
      })
      .catch(error => console.error('Error fetching data:', error));
      
//---------------------------------------------------------------------------------
            
      

    </script>
  </body>
</html>
